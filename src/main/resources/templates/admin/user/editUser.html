<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/fragments/layout}">
<head>
<title>Tài khoản</title>
<link th:href="@{admin/css/user/update.css}" rel="stylesheet">
</head>
<body id="page-top">
	<div layout:fragment="content" id="content-wrapper">
		<div class="container-fluid">
			<!-- Breadcrumbs-->
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="#">Dashboard</a></li>
				<li class="breadcrumb-item active">Tables</li>
			</ol>
			<div class="card mb-3">
				<div class="card-header">
					<div class="row">
						<div class="col-md-6">
							<i class="fas fa-table"></i> Quản lý tài khoản
						</div>
					</div>
				</div>
				<div class="formUpdate">
					<div class="row">
						<div class="col-md-12">
							<h2 class="headerUpdate">Cập nhật tài khoản</h2>
						</div>
					</div>
					<form class="form" id="formUpdateUser">
						<div class="row">
							<div class="form-group col-md-6">
								<label for="username" class="form-label">Username</label> <input
									id="username" disabled="disabled" type="text" class="form-control"
									th:value="${oldUser.username}">
									
							</div>
						</div>
						<div class="row">
							<div class="form-group col-md-6">
								<label for="fullname" class="form-label">Fullname</label> <input
									id="fullname" name="fullname" type="text" class="form-control"
									th:value="${oldUser.fullname}">
									<span class="form-message"></span>
							</div>
							<div class="form-group col-md-6">
								<label for="email" class="form-label">Email</label> <input
									id="email" name="email" type="text"
									placeholder="VD: email@domain.com" class="form-control"
									th:value="${oldUser.email}"> <span class="form-message"></span>
							</div>
						</div>
						<div class="row">
							<div class="form-group col-md-3">
								<label for="username" class="form-label">Năm sinh</label> <select
									id="yearOfBirth" name="yearOfBirth" class="form-control" size="3">
									<option value="1951" th:selected="${oldUser.yearOfBirth} == '1951'">1951</option>
									<option value="1952" th:selected="${oldUser.yearOfBirth} == '1952'">1952</option>
									<option value="1953" th:selected="${oldUser.yearOfBirth} == '1953'">1953</option>
									<option value="1954" th:selected="${oldUser.yearOfBirth} == '1954'">1954</option>
									<option value="1955" th:selected="${oldUser.yearOfBirth} == '1955'">1955</option>
									<option value="1956" th:selected="${oldUser.yearOfBirth} == '1956'">1956</option>
									<option value="1957" th:selected="${oldUser.yearOfBirth} == '1957'">1957</option>
									<option value="1958" th:selected="${oldUser.yearOfBirth} == '1958'">1958</option>
									<option value="1959" th:selected="${oldUser.yearOfBirth} == '1959'">1959</option>
									<option value="1960" th:selected="${oldUser.yearOfBirth} == '1960'">1960</option>
									<option value="1961" th:selected="${oldUser.yearOfBirth} == '1961'">1961</option>
									<option value="1962" th:selected="${oldUser.yearOfBirth} == '1962'">1962</option>
									<option value="1963" th:selected="${oldUser.yearOfBirth} == '1963'">1963</option>
									<option value="1964" th:selected="${oldUser.yearOfBirth} == '1964'">1964</option>
									<option value="1965" th:selected="${oldUser.yearOfBirth} == '1965'">1965</option>
									<option value="1966" th:selected="${oldUser.yearOfBirth} == '1966'">1966</option>
									<option value="1967" th:selected="${oldUser.yearOfBirth} == '1967'">1967</option>
									<option value="1968" th:selected="${oldUser.yearOfBirth} == '1968'">1968</option>
									<option value="1969" th:selected="${oldUser.yearOfBirth} == '1969'">1969</option>
									<option value="1970" th:selected="${oldUser.yearOfBirth} == '1970'">1970</option>
									<option value="1971" th:selected="${oldUser.yearOfBirth} == '1971'">1971</option>
									<option value="1972" th:selected="${oldUser.yearOfBirth} == '1972'">1972</option>
									<option value="1973" th:selected="${oldUser.yearOfBirth} == '1973'">1973</option>
									<option value="1974" th:selected="${oldUser.yearOfBirth} == '1974'">1974</option>
									<option value="1975" th:selected="${oldUser.yearOfBirth} == '1975'">1975</option>
									<option value="1976" th:selected="${oldUser.yearOfBirth} == '1976'">1976</option>
									<option value="1977" th:selected="${oldUser.yearOfBirth} == '1977'">1977</option>
									<option value="1978" th:selected="${oldUser.yearOfBirth} == '1978'">1978</option>
									<option value="1979" th:selected="${oldUser.yearOfBirth} == '1979'">1979</option>
									<option value="1980" th:selected="${oldUser.yearOfBirth} == '1980'">1980</option>
									<option value="1981" th:selected="${oldUser.yearOfBirth} == '1981'">1981</option>
									<option value="1982" th:selected="${oldUser.yearOfBirth} == '1982'">1982</option>
									<option value="1983" th:selected="${oldUser.yearOfBirth} == '1983'">1983</option>
									<option value="1984" th:selected="${oldUser.yearOfBirth} == '1984'">1984</option>
									<option value="1985" th:selected="${oldUser.yearOfBirth} == '1985'">1985</option>
									<option value="1986" th:selected="${oldUser.yearOfBirth} == '1986'">1986</option>
									<option value="1987" th:selected="${oldUser.yearOfBirth} == '1987'">1987</option>
									<option value="1988" th:selected="${oldUser.yearOfBirth} == '1988'">1988</option>
									<option value="1989" th:selected="${oldUser.yearOfBirth} == '1989'">1989</option>
									<option value="1990" th:selected="${oldUser.yearOfBirth} == '1990'">1990</option>
									<option value="1991" th:selected="${oldUser.yearOfBirth} == '1991'">1991</option>
									<option value="1992" th:selected="${oldUser.yearOfBirth} == '1992'">1992</option>
									<option value="1993" th:selected="${oldUser.yearOfBirth} == '1993'">1993</option>
									<option value="1994" th:selected="${oldUser.yearOfBirth} == '1994'">1994</option>
									<option value="1995" th:selected="${oldUser.yearOfBirth} == '1995'">1995</option>
									<option value="1996" th:selected="${oldUser.yearOfBirth} == '1996'">1996</option>
									<option value="1997" th:selected="${oldUser.yearOfBirth} == '1997'">1997</option>
									<option value="1998" th:selected="${oldUser.yearOfBirth} == '1998'">1998</option>
									<option value="1999" th:selected="${oldUser.yearOfBirth} == '1999'">1999</option>
									<option value="2000" th:selected="${oldUser.yearOfBirth} == '2000'">2000</option>
									<option value="2001" th:selected="${oldUser.yearOfBirth} == '2001'">2001</option>
									<option value="2002" th:selected="${oldUser.yearOfBirth} == '2002'">2002</option>
									<option value="2003" th:selected="${oldUser.yearOfBirth} == '2003'">2003</option>
									<option value="2004" th:selected="${oldUser.yearOfBirth} == '2004'">2004</option>
									<option value="2005" th:selected="${oldUser.yearOfBirth} == '2005'">2005</option>
									<option value="2006" th:selected="${oldUser.yearOfBirth} == '2006'">2006</option>
									<option value="2007" th:selected="${oldUser.yearOfBirth} == '2007'">2007</option>
									<option value="2008" th:selected="${oldUser.yearOfBirth} == '2008'">2008</option>
									<option value="2009" th:selected="${oldUser.yearOfBirth} == '2009'">2009</option>
									<option value="2010" th:selected="${oldUser.yearOfBirth} == '2010'">2010</option>
								</select> <span class="form-message"></span>
							</div>
						</div>
						<div class="row">
							<div class="form-group col-md-6">
								<label for="password" class="form-label">Mật khẩu</label> <input
									id="password" name="password" type="password"
									placeholder="Nhập mật khẩu" class="form-control"
									th:value="${oldUser.password}"> <span
									class="form-message"></span>
							</div>
							<div class="form-group col-md-6">
								<label for="password_confirmation" class="form-label">Nhập
									lại mật khẩu</label> <input id="password_confirmation"
									placeholder="Nhập lại mật khẩu" type="password"
									class="form-control" th:value="${oldUser.password}"> <span
									class="form-message"></span>
							</div>
						</div>

						<div class="form-group row">
							<div class="col-md-6">
								<label for="roleCode">Vai trò:</label> <select id="roleCode"
									name="roleCode" class="form-control">
									<option value="">------CHỌN VAI TRÒ-----</option>
									<th:block th:each="role : ${roles}">
										<option th:value="${role.code}" th:utext="${role.name}"
											th:selected="(${roleChooses.code} == ${role.code})"></option>
									</th:block>
								</select> <span class="form-message"></span>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-6 row">

								<div class="col-md-2">
									<input type="radio" name="gender" value="1"
										th:checked="${oldUser.gender == 'Nam'}"> <label for="male"
										style="margin-top: 20px; margin-left: 10px;">Nam</label><br>
								</div>
								<div class="col-md-2">
									<input type="radio" name="gender" value="0"
										th:checked="${oldUser.gender == 'Nữ'}"> <label
										for="female" style="margin-top: 20px; margin-left: 10px;">Nữ</label><br>
								</div>
							</div>

						</div>
						<input type="hidden" th:value="${oldUser.id}" id="idUser"
							name="id">
						<div class="row">
							<div class="col-md-12">
								<button type="submit" class="btn btn-primary"
									style="margin: 30px;" id="btnAddUser">Lưu thay đổi</button>
							</div>
						</div>
					</form>
				</div>


			</div>
		</div>
		<script type="text/javascript">
			// Mong muốn của chúng ta
			Validator({
				form : '#formUpdateUser',
				formGroupSelect : '.form-group',
				errorSelector : '.form-message',
				rules : [
						Validator.isEmail('#email', 'Phải nhập đúng email !'),
						Validator.isRequired('#fullname',
						'Vui lòng không để trống !'),
						Validator.isRequired('#yearOfBirth',
						'Vui lòng không để trống !'),
						Validator.isRequired('#password',
								'Vui lòng không để trống !'),
						Validator.isRequired('#password_confirmation',
								'Vui lòng không để trống !'),
						Validator.minLength('#password', 6,
								'Tối thiểu phải nhập 6 ký tự !'),
						Validator.isRequired('#roleCode',
								'Vui lòng nhập trường này !'),
						Validator
								.isConfirm(
										'#password_confirmation',
										function() {
											return document
													.querySelector('#formUpdateUser #password').value;
										},
										'Mật khẩu nhập lại không chính xác !'), ],
				onSubmit : function(data) {
					console.log(data);
					$.ajax({
						url : '/users',
						type : 'PUT',
						contentType : 'application/json',
						data : JSON.stringify(data),
						dataType : 'json',
						success : function(response) {
							window.location.href = "/listUser";
							alert("Cập nhật tài khoản thành công !");
						},
						error : function(response) {
							window.location.href = "/listUser";
							alert("Lỗi hệ thống !");
						}
					});
				}
			});

			
		</script>
</body>
</html>

